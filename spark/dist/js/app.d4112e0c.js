(function(e){function t(t){for(var n,s,o=t[0],c=t[1],u=t[2],l=0,f=[];l<o.length;l++)s=o[l],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&f.push(r[s][0]),r[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(f.length)f.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,s=1;s<a.length;s++){var c=a[s];0!==r[c]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},r={app:0},i=[];function s(e){return o.p+"js/"+({about:"about"}[e]||e)+"."+{about:"108e532d"}[e]+".js"}function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(e){var t=[],a=r[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise((function(t,n){a=r[e]=[t,n]}));t.push(a[2]=n);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=s(e);var u=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(l);var a=r[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+n+": "+i+")",u.name="ChunkLoadError",u.type=n,u.request=i,a[1](u)}r[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var d=u;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"472f":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t),a.d(t,"db",(function(){return kt}));a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container",attrs:{id:"app"}},[a("Main")],1)},i=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper"},[a("div",{staticClass:"top-wrapper"},[a("Header"),a("router-view")],1),a("Footer")],1)},o=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"text-left col-6"},[a("router-link",{attrs:{to:"/"}},[a("h3",{staticClass:"home-title"},[e._v("SPARK")])])],1),a("div",{staticClass:"text-right col-6"},[a("router-link",{attrs:{to:"/about"}},[e._v("About")]),e._v(" | "),e.loggedIn?a("span",[a("div",{staticClass:"dropdown-content",attrs:{id:"myDropdown"}},[a("button",{class:{hasNotifications:e.isActive},on:{click:function(t){return e.removeNotifications()}}},[a("router-link",{attrs:{to:"/profile"}},[e._v(e._s(e.user.username))])],1),a("br"),a("router-link",{directives:[{name:"show",rawName:"v-show",value:e.user.audio,expression:"user.audio"}],attrs:{to:"/spark"}},[e._v("Spark Queue")]),a("Authlog")],1)]):a("span",[a("router-link",{attrs:{to:"/login"}},[e._v("Login")]),e._v(" | "),a("router-link",{attrs:{to:"/register"}},[e._v("Register")]),e._v(" | ")],1)],1)])},u=[],l=a("59ca"),d=a.n(l),f=(a("ea7b"),a("66ce"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("button",{on:{click:e.signOut}},[e._v("Sign out")])])}),h=[],p=(a("ac1f"),a("5319"),a("96cf"),a("1da1")),m=(a("e71f"),{data:function(){return{loggedIn:!1}},methods:{signOut:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l["auth"]().signOut();case 3:a=t.sent,console.log("signed out",a),e.$store.dispatch("resetCurrentState"),e.$router.replace({name:"Login"}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()}},created:function(){var e=this;l["auth"]().onAuthStateChanged((function(t){e.loggedIn=!!t}))}}),v=m,g=a("2877"),b=Object(g["a"])(v,f,h,!1,null,null,null),y=b.exports,k={components:{Authlog:y},data:function(){return{loggedIn:!1,activeClass:"hasNotifications",isActive:!1,id:""}},created:function(){var e=this;this.loggedIn&&(this.id=l["auth"]().currentUser.uid),l["auth"]().onAuthStateChanged((function(t){t?(e.loggedIn=!0,e.$store.dispatch("fetchUserData")):e.loggedIn=!1})),l["database"]().ref("status/"+this.id).on("value",(function(t){e.loggedIn&&t.val().hasNotification?e.isActive=!0:console.log("nothing going on here")}))},methods:{removeNotifications:function(){console.log("remove"),l["database"]().ref("status/"+this.id).update({hasNotification:!1}),this.isActive=!1}},computed:{user:function(){return this.$store.getters.user}}},w=k,_=Object(g["a"])(w,c,u,!1,null,null,null),U=_.exports,E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v(" Footer ")])},x=[],$={},D=$,I=Object(g["a"])(D,E,x,!1,null,null,null),M=I.exports,A={components:{Header:U,Footer:M},data:function(){return{id:""}},created:function(){}},P=A,L=Object(g["a"])(P,s,o,!1,null,null,null),S=L.exports,j={components:{Main:S}},O=j,N=Object(g["a"])(O,r,i,!1,null,null,null),C=N.exports,B=(a("45fc"),a("d3b7"),a("8c4f")),F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.currentUser&&!e.user.audio,expression:"currentUser && !user.audio"}]},[a("p",[e._v("Remember to upload an audiofile")])]),e.currentUser?a("h1",[e._v("Welcome "+e._s(e.user.username))]):a("h1",[e._v("Welcome to Spark")])])},T=[],R={name:"Home",components:{},data:function(){return{currentUser:!1}},props:["cUserData"],created:function(){var e=l["auth"]().currentUser;e&&(this.currentUser=!0,this.$store.dispatch("fetchUserData"))},computed:{user:function(){return this.$store.getters.user}}},V=R,H=Object(g["a"])(V,F,T,!1,null,null,null),W=H.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v(" Login "),e.error?a("div",[e._v(" "+e._s(e.error.message)+" ")]):e._e(),a("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",placeholder:"e-mailadress"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),a("button",{attrs:{type:"submit"}},[e._v("Login")])]),a("router-link",{attrs:{to:"resetpassword"}},[e._v("Forgot password?")]),a("p",[e._v("Don't have an account yet? "),a("router-link",{attrs:{to:"/register"}},[e._v("Register")])],1)],1)},K=[],Y={data:function(){return{email:"",password:"",error:""}},created:function(){var e=l["auth"]().currentUser;e&&this.$router.replace({name:"Home"})},methods:{onSubmit:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,""!=e.email&&""!=e.password){t.next=5;break}e.fieldError(),t.next=11;break;case 5:if(""==e.email&&""==e.password){t.next=11;break}return t.next=8,l["auth"]().signInWithEmailAndPassword(e.email,e.password);case 8:t.sent,e.$router.replace({name:"Home"});case 11:t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),e.credentialError();case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},credentialError:function(){this.$notify({message:"These credentials do not match!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})},fieldError:function(){this.$notify({message:"Please fill in all fields!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})}}},q=Y,J=Object(g["a"])(q,z,K,!1,null,"3791af85",null),Z=J.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v(" Register "),e.error?a("div",[e._v(" "+e._s(e.error.message)+" ")]):e._e(),a("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",placeholder:"Username",minlength:"2",maxlength:"32"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}})]),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",placeholder:"e-mailadress"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"Password",minlength:"7"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]),a("div",[a("input",{ref:"passwordval",attrs:{type:"password",placeholder:"Retype password"}})]),a("button",{attrs:{type:"submit"}},[e._v("Register")])]),a("p",[e._v("Already have an account? "),a("router-link",{attrs:{to:"/login"}},[e._v("Login")])],1)])},Q=[],X=(a("588e"),{data:function(){return{username:"",email:"",password:"",bio:"",picture:"",error:"",standard:"https://firebasestorage.googleapis.com/v0/b/spark-a6f3f.appspot.com/o/standard%2Fspark_logo.png?alt=media&token=c5efe70e-527f-4986-9827-71360a4e2f91"}},created:function(){var e=l["auth"]().currentUser;e&&this.$router.replace({name:"Home"})},methods:{onSubmit:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e.$refs.passwordval.value,""==e.email||""==e.username||""==e.password||""==a?e.fieldError():a==e.password?l["auth"]().createUserWithEmailAndPassword(e.email,e.password).then((function(t){if(t){var a=l["auth"]().currentUser;a.updateProfile({displayName:e.username}),kt.collection("users").doc(a.uid).set({userId:a.uid,username:e.username,bio:"My Bio",isAdmin:!1,picture:e.standard,audio:"",links:{soundcloud:{link:"",class:"soundcloud"},spotify:{link:"",class:"spotify"},facebook:{link:"",class:"facebook"},instagram:{link:"",class:"instagram"}}}),kt.collection("matches").doc(a.uid).collection("myMatches").doc("Activated").set({activated:!0}),kt.collection("matches").doc(a.uid).collection("usersMet").doc(a.uid).set({activated:!0}),e.sendVerificationEmail(),e.succesNotification(),e.$router.replace({name:"Home"})}})).catch((function(t){console.log(t),e.emailError()})):e.passwordError();case 2:case"end":return t.stop()}}),t)})))()},sendVerificationEmail:function(){var e=l["auth"]().currentUser;e.sendEmailVerification().then((function(){console.log("email sent")})).catch((function(e){console.log(e)}))},fieldError:function(){this.$notify({message:"Please fill in all fields!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})},passwordError:function(){this.$notify({message:"Passwords don't match!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})},credentialError:function(){this.$notify({message:"These credentials do not match!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})},emailError:function(){this.$notify({message:"Email already in use!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})},succesNotification:function(){this.$notify({message:"Verification email sent to "+this.email,top:!0,right:!0,type:"succes",theme:{colors:{succes:"#fofofo"}}})}}}),ee=X,te=Object(g["a"])(ee,G,Q,!1,null,null,null),ae=te.exports,ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",[e._v(" "+e._s(e.cUserData.cUsername)+" "),a("br"),e._v(" "+e._s(e.cUserData.cBio)+" "),a("br"),a("input",{ref:"bioInput",attrs:{type:"text",placeholder:e.cUserData.cBio}}),a("button",{on:{click:function(t){return e.editBio()}}},[e._v("Edit")]),0==e.cUserData.cIsAdmin?a("div",[e._v("You're not an admin")]):a("div",[e._v("Welcome admin")])])])},re=[],ie=(a("25f0"),{data:function(){return{id:"",cUserData:{cUsername:"",cBio:"",cIsAdmin:null}}},created:function(){var e=this,t=l["auth"]().currentUser;this.id=t.uid,this.id=this.id.toString(),kt.collection("users").doc(this.id).get().then((function(t){var a=t.data();e.cUserData.cUsername=a.username,e.cUserData.cBio=a.bio,e.cUserData.cIsAdmin=a.isAdmin,console.log("User Data",e.cUserData)}))},methods:{editBio:function(){var e=this.$refs.bioInput.value;console.log(e),e?(kt.collection("users").doc(this.id).update({bio:e}),this.$refs.bioInput.value=e,console.log("epic")):alert("error")}}}),se=ie,oe=Object(g["a"])(se,ne,re,!1,null,null,null),ce=oe.exports,ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",[e._v(e._s(e.userData.username))]),a("br"),a("p",[e._v(e._s(e.userData.bio))]),a("br"),a("img",{attrs:{src:e.userData.picture,alt:e.userData.username+"s profilepicture"}})])},le=[],de={data:function(){return{id:this.$route.params.id,userData:{bio:"",username:"",picture:""}}},created:function(){var e=this;kt.collection("users").doc(this.id).get().then((function(t){var a=t.data();e.userData.username=a.username,e.userData.bio=a.bio,e.userData.picture=a.picture}))}},fe=de,he=Object(g["a"])(fe,ue,le,!1,null,null,null),pe=he.exports,me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.userVerified?a("div",[a("img",{attrs:{src:e.user.picture}}),a("br"),e._v(" "+e._s(e.user.username)+" "),a("br"),e._v(" "+e._s(e.user.bio)+" "),a("br"),0==e.user.isAdmin?a("div",[e._v("You're not an admin")]):a("div",[e._v("Welcome admin")]),a("button",[a("router-link",{attrs:{to:"/edit"}},[e._v("Edit profile")])],1),e.user.audio?a("div",[a("mini-audio",{attrs:{html5:!0,src:e.user.audio}})],1):a("div",[e._v("Upload an mp3")]),a("div",{staticClass:"socials"},[a("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.links.soundcloud.link,expression:"links.soundcloud.link != ''"}],class:e.links.soundcloud.class},[e._v("Soundcloud")]),a("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.links.spotify.link,expression:"links.spotify.link != ''"}],class:e.links.spotify.class},[e._v("Spotify")]),a("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.links.facebook.link,expression:"links.facebook.link != ''"}],class:e.links.facebook.class},[e._v("Facebook")]),a("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.links.instagram.link,expression:"links.instagram.link != ''"}],class:e.links.instagram.class},[e._v("Instagram")])]),a("Friends")],1):a("div",[e._v(" Verification email sent "),a("br"),a("button",{on:{click:function(t){return e.sendVerificationEmail()}}},[e._v("Send another email")])])])},ve=[],ge=(a("4160"),a("466d"),a("159b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",[e._v("Your Sparks")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.searchInput,expression:"searchInput"}],attrs:{type:"text"},domProps:{value:e.searchInput},on:{input:function(t){t.target.composing||(e.searchInput=t.target.value)}}}),e.myMatches[0]?e._l(e.filteredList,(function(t){return a("div",{key:t.id},[a("button",[a("router-link",{attrs:{to:"profile/"+t.id}},[e._v(e._s(t.name))])],1)])})):a("div",[e._v(" No sparks yet ")])],2)}),be=[],ye=(a("4de4"),a("caad"),a("b0c0"),a("2532"),{data:function(){return{myMatches:[],counter:0,id:"",searchInput:""}},created:function(){var e=this;this.$store.dispatch("fetchUserData");var t=l["auth"]().currentUser.uid,a=[];kt.collection("matches").doc(t).collection("myMatches").orderBy("date").get().then((function(t){t.forEach((function(t){void 0!=t.data().match&&(a.push(t.data()),e.counter++)}))})),this.myMatches=a,console.log(this.myMatches)},methods:{},computed:{user:function(){return this.$store.getters.user},filteredList:function(){var e=this;return this.myMatches.filter((function(t){return t.name.toLowerCase().includes(e.searchInput.toLowerCase())}))}}}),ke=ye,we=Object(g["a"])(ke,ge,be,!1,null,"66b6a139",null),_e=we.exports,Ue={data:function(){return{myMatches:[],userVerified:!1,links:{soundcloud:"",spotify:"",facebook:"",instagram:""}}},components:{Friends:_e},created:function(){var e=this,t=l["auth"]().currentUser;this.userVerified=t.emailVerified,this.$store.dispatch("fetchUserData");var a=l["auth"]().currentUser.uid,n=[];kt.collection("users").doc(a).get().then((function(t){var a=t.data();e.links.soundcloud=a.links.soundcloud,e.links.spotify=a.links.spotify,e.links.facebook=a.links.facebook,e.links.instagram=a.links.instagram})),kt.collection("matches").doc(a).collection("myMatches").get().then((function(e){e.forEach((function(e){void 0!=e.data().match&&n.push(e.data())}))})),this.myMatches=n},methods:{sendVerificationEmail:function(){var e=l["auth"]().currentUser;e.sendEmailVerification().then((function(){console.log("email sent")})).catch((function(e){}))}},computed:{user:function(){return this.$store.getters.user}}},Ee=Ue,xe=Object(g["a"])(Ee,me,ve,!1,null,null,null),$e=xe.exports,De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("form",{on:{submit:function(t){return t.preventDefault(),e.resetPassword(t)}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),a("button",{attrs:{type:"submit"}},[e._v("Send email")])])])},Ie=[],Me={data:function(){return{email:""}},methods:{resetPassword:function(){var e=this,t=l["auth"](),a=this.email;""!=this.email?t.sendPasswordResetEmail(a).then((function(t){e.$router.replace({name:"Login"}),e.succes()})).catch((function(e){console.log(e)})):this.error()},succes:function(){this.$notify({message:"Email sent!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})},error:function(){this.$notify({message:"Please enter a valid email!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})}}},Ae=Me,Pe=Object(g["a"])(Ae,De,Ie,!1,null,null,null),Le=Pe.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",[e._v(" Username: "),a("input",{ref:"usernameInput",attrs:{type:"text"},domProps:{value:e.cUserData.cUsername}}),a("br"),e._v(" Bio: "),a("input",{ref:"bioInput",attrs:{type:"text"},domProps:{value:e.cUserData.cBio}}),a("br"),a("input",{ref:"soundcloudInput",attrs:{type:"text",placeholder:"Soundcloud"},domProps:{value:e.cUserData.cLinks.soundcloud}}),a("input",{ref:"spotifyInput",attrs:{type:"text",placeholder:"Spotify"},domProps:{value:e.cUserData.cLinks.spotify}}),a("input",{ref:"facebookInput",attrs:{type:"text",placeholder:"Facebook"},domProps:{value:e.cUserData.cLinks.facebook}}),a("input",{ref:"instagramInput",attrs:{type:"text",placeholder:"Instagram"},domProps:{value:e.cUserData.cLinks.instagram}}),a("br"),a("button",{on:{click:function(t){return e.editProfile()}}},[a("a",{attrs:{href:"/profile"}},[e._v("Save info")])]),a("img",{ref:"myImg",attrs:{src:e.cUserData.cPicture}}),a("br"),e._v(" profile picture "),a("input",{ref:"myFile",attrs:{type:"file"},on:{change:function(t){return e.getFile()}}}),a("br"),e._v(" audio (max 1mb) "),a("input",{ref:"myAudio",attrs:{type:"file"},on:{change:function(t){return e.getAudio()}}}),a("button",[a("router-link",{attrs:{to:"/profile"}},[e._v("Back without saving")])],1)])])},je=[],Oe=(a("9911"),{data:function(){return{id:"",cUserData:{cUsername:"",cBio:"",cPicture:"",cIsAdmin:null,cLinks:{soundcloud:"",spotify:"",facebook:"",instagram:""}},file:{},hasFile:!1,audio:{},hasAudio:!1,user:{}}},created:function(){var e=this;this.user=l["auth"]().currentUser,this.id=this.user.uid,this.id=this.id.toString(),kt.collection("users").doc(this.id).get().then((function(t){var a=t.data();e.cUserData.cUsername=a.username,e.cUserData.cBio=a.bio,e.cUserData.cIsAdmin=a.isAdmin,e.cUserData.cPicture=a.picture,void 0!==a.links&&(e.cUserData.cLinks.soundcloud=a.links.soundcloud.link,e.cUserData.cLinks.spotify=a.links.spotify.link,e.cUserData.cLinks.facebook=a.links.facebook.link,e.cUserData.cLinks.instagram=a.links.instagram.link)}))},methods:{getFile:function(){this.file=this.$refs.myFile.files[0],this.hasFile=!0,this.editPicture()},getAudio:function(){this.audio=this.$refs.myAudio.files[0],this.hasAudio=!0,this.editAudio()},editPicture:function(){var e=this,t=this.user,a=l["storage"]().ref("users/"+this.user.uid+"/profile"+Date.now().toString()+".jpg");this.file&&this.file.size<1048576?(a.put(this.file).then((function(n){var r=t.uid;console.log("Uploaded!"),a.getDownloadURL().then((function(t){console.log(t),kt.collection("users").doc(r).update({picture:t}),e.fileUploaded()}))})).catch((function(t){e.imageError()})),this.hasFile=!1):this.fileError()},editAudio:function(){var e=this,t=this.user,a=l["storage"]().ref("audio/"+this.user.uid+"/audio.mp3");console.log(a),this.audio&&this.audio.size<1048576?(a.put(this.audio).then((function(n){var r=t.uid;console.log("Uploaded!"),a.getDownloadURL().then((function(t){console.log(t),kt.collection("users").doc(r).update({audio:t}),e.fileUploaded()}))})).catch((function(t){e.audioError()})),this.hasAudio=!1):this.fileError()},addLinks:function(){var e=this.$refs.soundcloudInput.value,t=this.$refs.spotifyInput.value,a=this.$refs.facebookInput.value,n=this.$refs.instagramInput.value;kt.collection("users").doc(this.user.uid).update({links:{soundcloud:{link:e,class:"soundcloud"},spotify:{link:t,class:"spotify"},facebook:{link:a,class:"facebook"},instagram:{link:n,class:"instagram"}}})},editProfile:function(){var e=this.$refs.bioInput.value,t=this.$refs.usernameInput.value;e||t?(kt.collection("users").doc(this.id).update({bio:e,username:t}),this.$refs.bioInput.value=e,this.$refs.usernameInput.value=t,this.addLinks()):alert("error")},fileError:function(){this.$notify({message:"File exceeds the 1MB limit!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})},imageError:function(){this.$notify({message:"File is not an image!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})},audioError:function(){this.$notify({message:"File is not an mp3!",top:!0,right:!0,type:"warning",theme:{colors:{warning:"#f8a623"}}})},fileUploaded:function(){this.$notify({message:"File uploaded!",top:!0,right:!0,type:"succes",theme:{colors:{succes:"#fofofo"}}})}}}),Ne=Oe,Ce=Object(g["a"])(Ne,Se,je,!1,null,null,null),Be=Ce.exports,Fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.potentialMatches.length>0&&!e.arrayEmpty?a("div",[a("h3",[e._v(e._s(e.potentialMatches[e.counter].username))]),a("mini-audio",{attrs:{html5:!0,src:e.potentialMatches[e.counter].audio}}),a("button",{on:{click:function(t){return e.likeUser()}}},[e._v("Like")]),a("button",{on:{click:function(t){return e.addUserToDB()}}},[e._v("Next")])],1):0!=e.potentialMatches.length&&!e.arrayEmpty||e.noUsers?e.noUsers?a("div",[e._v(" No more users in the queue, please come back later... ")]):e._e():a("div",[e._v(" loading ")])])},Te=[],Re={data:function(){return{count:0,counter:0,userList:[],arrayEmpty:!1,id:"",audioState:"paused"}},props:["potentialMatches","arrayLength","noUsers"],watch:{potentialMatches:function(){this.potentialMatches.length==this.arrayLength&&(this.arrayEmpty=!1)}},methods:{next:function(){this.counter==this.potentialMatches.length-1?(this.arrayEmpty=!0,this.reload()):this.counter++},reload:function(){this.counter=0,this.$emit("clicked","reload")},addUserToDB:function(){kt.collection("matches").doc(this.id).collection("usersMet").doc(this.potentialMatches[this.counter].id).set({activated:!0}).then(this.next())},likeUser:function(){var e=this;l["database"]().ref("status/"+this.potentialMatches[this.counter].id+"/pending/"+this.id).once("value",(function(t){null==t.val()?(l["database"]().ref("status/"+e.id+"/pending/"+e.potentialMatches[e.counter].id).set({pending:1}),e.addUserToDB()):(kt.collection("matches").doc(e.id).collection("myMatches").doc(e.potentialMatches[e.counter].id).set({match:1,name:e.potentialMatches[e.counter].username,id:e.potentialMatches[e.counter].id,date:l["database"].ServerValue.TIMESTAMP}),kt.collection("matches").doc(e.potentialMatches[e.counter].id).collection("myMatches").doc(e.id).set({match:1,name:e.user.username,id:e.id,date:l["database"].ServerValue.TIMESTAMP}),l["database"]().ref("status/"+e.id).update({hasNotification:!0}),e.newMatch(),e.addUserToDB(),l["database"]().ref("status/"+e.potentialMatches[e.counter].id).update({hasNotification:!0}),e.newMatch(),e.addUserToDB())}))},newMatch:function(){this.$notify({message:"You've got a new Spark!",top:!0,right:!0,type:"succes",theme:{colors:{succes:"#fofofo"}}})}},computed:{user:function(){return this.$store.getters.user}},created:function(){this.$store.dispatch("fetchUserData"),this.id=l["auth"]().currentUser.uid}},Ve=Re,He=Object(g["a"])(Ve,Fe,Te,!1,null,null,null),We=He.exports,ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.started?a("div",[a("Matching",{attrs:{potentialMatches:e.usersData,arrayLength:e.arrayLength,noUsers:e.noUsers},on:{clicked:e.emptyArray}})],1):a("div",[a("button",{on:{click:function(t){return e.getPotentialMatches()}}},[e._v("Start")])])])},Ke=[],Ye={components:{Matching:We},data:function(){return{userList:[],usersData:[],started:!1,arrayLength:0,noUsers:!1}},created:function(){this.loading=!0;var e=l["auth"]().currentUser.uid,t=l["database"]().ref("/status/"+e),a={state:"offline",last_changed:l["database"].ServerValue.TIMESTAMP},n={state:"online",last_changed:l["database"].ServerValue.TIMESTAMP},r={id:e};t.update(r),l["database"]().ref("status").once("value",(function(e){e.forEach((function(e){void 0==e.val().id&&l["database"]().ref("status/"+e.key).remove()}))})),l["database"]().ref(".info/connected").on("value",(function(e){0!=e.val()&&t.onDisconnect().update(a).then((function(){t.update(n)}))}))},methods:{getPotentialMatches:function(){var e=this,t=l["auth"]().currentUser.uid;l["database"]().ref("status").orderByChild("last_changed").limitToLast(50).once("value",(function(a){var n=[];e.noUsers=!1,console.log("looking for potential matches"),kt.collection("matches").doc(t).collection("usersMet").get().then((function(r){r.forEach((function(e){n.push(e.id)})),console.log("filling list"),a.forEach((function(a){if(n.includes(a.val().id)||a.val().id==t)console.log("user met");else{if(10==e.userList.length)return e.userList;e.userList.push(a.val().id)}})),console.log("getting users data"),e.userList.forEach((function(t){kt.collection("users").doc(t).get().then((function(t){var a=t.data();e.usersData.push({id:a.userId,username:a.username,bio:a.bio,audio:a.audio})}))})),e.arrayLength=e.userList.length,0==e.arrayLength&&(e.noUsers=!0),console.log("data pending")}))})),this.started=!0},emptyArray:function(){this.started=!1,this.userList=[],this.usersData=[],0==this.userList.length&&0==this.usersData.length&&this.getPotentialMatches()}}},qe=Ye,Je=Object(g["a"])(qe,ze,Ke,!1,null,null,null),Ze=Je.exports,Ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v(" "+e._s(e.welcome)+" ")])},Qe=[],Xe={data:function(){return{welcome:""}},created:function(){var e=l["auth"]().currentUser;1==e.isAdmin?this.welcome="welcome admin":this.welcome="nice try"}},et=Xe,tt=Object(g["a"])(et,Ge,Qe,!1,null,"2fefb69e",null),at=tt.exports;n["default"].use(B["a"]);var nt=[{path:"/",name:"Home",component:W},{path:"/about",name:"About",component:function(){return a.e("about").then(a.bind(null,"f820"))}},{path:"/login",name:"Login",component:Z},{path:"/register",name:"Register",component:ae},{path:"/profile",name:"Profile",component:$e,meta:{Authenticated:!0}},{path:"/edit",name:"Edit",component:Be,meta:{Authenticated:!0}},{path:"/test",name:"Authtest",component:ce,meta:{Authenticated:!0}},{path:"/test",name:"Matching",component:We,meta:{Authenticated:!0}},{path:"/spark",name:"Testing",component:Ze,meta:{Authenticated:!0}},{path:"/profile/:id",name:"Friend",component:pe,meta:{Authenticated:!0}},{path:"/admin",name:"Admin",component:at,meta:{Authenticated:!0}},{path:"/resetpassword",name:"Reset",component:Le}],rt=new B["a"]({mode:"history",base:"/",routes:nt});rt.beforeEach((function(e,t,a){var n=e.matched.some((function(e){return e.meta.Authenticated})),r=l["auth"]().currentUser;n&&!r?a("/login"):a()}));var it=rt,st=a("2f62");n["default"].use(st["a"]);var ot=function(){return{user:{},recentUsers:[]}},ct=new st["a"].Store({state:ot(),mutations:{setUser:function(e,t){if(t){var a=t.username,n=t.bio,r=t.isAdmin,i=t.picture,s=t.audio;e.user={username:a,bio:n,isAdmin:r,picture:i,audio:s}}else e.user={}},resetState:function(e){Object.assign(e,ot())}},actions:{fetchUserData:function(e){var t=e.commit,a=l["auth"]().currentUser,n=a.uid;kt.collection("users").doc(n).get().then((function(e){var a=e.data();t("setUser",a)}))},resetCurrentState:function(e){var t=e.commit;t("resetState")}},getters:{user:function(e){return e.user}},modules:{}}),ut=a("bc3a"),lt=a.n(ut),dt=a("0ff2"),ft=a("5f5b"),ht=(a("472f"),a("dad5")),pt=a.n(ht),mt=a("d10e"),vt=a("db49"),gt=a.n(vt);n["default"].use(mt["a"]),n["default"].use(pt.a),n["default"].use(dt["a"]),n["default"].use(ft["a"]),n["default"].prototype.$axios=lt.a,n["default"].config.productionTip=!1;var bt={apiKey:gt.a.firebase.apiKey,authDomain:gt.a.firebase.authDomain,databaseURL:gt.a.firebase.databaseURL,projectId:gt.a.firebase.projectId,storageBucket:gt.a.firebase.storageBucket,messagingSenderId:gt.a.firebase.messagingSenderId,appId:gt.a.firebase.appId,measurementId:gt.a.firebase.measurementId};d.a.initializeApp(bt);var yt,kt=d.a.firestore();d.a.auth().onAuthStateChanged((function(e){console.log(e),yt||(yt=new n["default"]({router:it,store:ct,render:function(e){return e(C)}}).$mount("#app"))}))},db49:function(e,t){var a={firebase:{apiKey:"AIzaSyCfH_x4DL7ipsEZ0s1qIeJ1aI7df_5ZHvE",authDomain:"spark-a6f3f.firebaseapp.com",databaseURL:"https://spark-a6f3f.firebaseio.com",projectId:"spark-a6f3f",storageBucket:"spark-a6f3f.appspot.com",messagingSenderId:"123726967246",appId:"1:123726967246:web:aa634ede9a1e98651c7b9f",measurementId:"G-BC683SF45H"}};e.exports=a}});
//# sourceMappingURL=app.d4112e0c.js.map